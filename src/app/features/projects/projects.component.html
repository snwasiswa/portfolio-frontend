<div class="page-container">
  <div class="section-title-wrapper">
    <h1 class="section-title">Projects</h1>
  </div>

  <!-- === Academic Projects === -->
  <div class="project-category">
    <h2>Academic Projects</h2>
    <div class="summary-text" *ngIf="profile?.academic_projects_summary"
         [innerHTML]="profile!.academic_projects_summary! | safeHtml">
    </div>

    <div class="scroll-wrapper">
      <button class="arrow-btn left" (click)="scroll(academicScroll, -300, 'academic')">&#8592;</button>

      <div class="scroll-container" #academicScrollContainer>
        <div class="project-card" *ngFor="let project of academicProjects">
          <img [src]="project.image" alt="{{ project.name }}" />

          <div class="project-info">
            <h4>{{ project.name }}</h4>
            <p>{{ project.description }}</p>

            <div class="button-container">
              <p-button *ngIf="project.url?.trim()" label="View Demo" icon="pi pi-arrow-right"
                        (onClick)="openLink(project.url)" class="custom-button"></p-button>

              <p-button *ngIf="project.images?.length" label="Preview" icon="pi pi-images"
                        (onClick)="openCarousel(project)" class="custom-button"></p-button>
            </div>
          </div>

          <div class="project-tech-stack">
            <strong>Tech Stack:</strong>
            <ul class="tech-list">
              <li *ngFor="let tech of project.technology">{{ tech }}</li>
            </ul>
          </div>
        </div>
      </div>

      <button class="arrow-btn right" (click)="scroll(academicScroll, 300, 'academic')">&#8594;</button>
    </div>

    <div class="dots">
      <span *ngFor="let _ of getDotCount(academicProjects); let i = index"
            [class.active]="isDotActive(i, 'academic')"></span>
    </div>
  </div>

  <!-- === Side Projects === -->
  <div class="project-category">
    <h2>Side Projects</h2>
    <div class="summary-text" *ngIf="profile?.side_projects_summary"
         [innerHTML]="profile!.side_projects_summary! | safeHtml"></div>

    <div class="scroll-wrapper">
      <button class="arrow-btn left" (click)="scroll(sideScroll, -300, 'side')">&#8592;</button>

      <div class="scroll-container" #sideScrollContainer>
        <div class="project-card" *ngFor="let project of sideProjects">
          <img [src]="project.image" alt="{{ project.name }}" />

          <div class="project-info">
            <h4>{{ project.name }}</h4>
            <p>{{ project.description }}</p>

            <div class="button-container">
              <p-button *ngIf="project.url?.trim()" label="View Demo" icon="pi pi-arrow-right"
                        (onClick)="openLink(project.url)" class="custom-button"></p-button>

              <p-button *ngIf="project.images?.length" label="Preview" icon="pi pi-images"
                        (onClick)="openCarousel(project)" class="custom-button"></p-button>
            </div>
          </div>

          <div class="project-tech-stack">
            <strong>Tech Stack:</strong>
            <ul class="tech-list">
              <li *ngFor="let tech of project.technology">{{ tech }}</li>
            </ul>
          </div>
        </div>
      </div>

      <button class="arrow-btn right" (click)="scroll(sideScroll, 300, 'side')">&#8594;</button>
    </div>

    <div class="dots">
      <span *ngFor="let _ of getDotCount(sideProjects); let i = index"
            [class.active]="isDotActive(i, 'side')"></span>
    </div>
  </div>
</div>

<!-- === Custom Floating Dialog === -->
<div *ngIf="displayCarousel" class="floating-dialog-overlay" (click)="closeCarousel()">
  <div class="floating-dialog carousel-dialog" (click)="$event.stopPropagation()">
    <div class="dialog-header">
      <h3 class="dialog-title">{{ selectedProject?.name }}</h3>
      <button class="close-btn" (click)="closeCarousel()">&times;</button>
    </div>

    <div class="dialog-body"
         *ngIf="selectedProject?.images?.length"
         (touchstart)="onTouchStart($event)"
         (touchend)="onTouchEnd($event)">

      <button class="carousel-nav left" (click)="prevSlide()">&#8592;</button>

      <div class="carousel-image-wrapper">
        <img [src]="selectedProject!.images![selectedProject!.currentSlide || 0]!.image"
             alt="{{ selectedProject!.name }} screenshot" />
      </div>

      <button class="carousel-nav right" (click)="nextSlide()">&#8594;</button>

      <div class="carousel-dots">
        <span *ngFor="let _ of selectedProject!.images; let i = index"
              [class.active]="i === (selectedProject!.currentSlide || 0)"></span>
      </div>
    </div>
  </div>
</div>
